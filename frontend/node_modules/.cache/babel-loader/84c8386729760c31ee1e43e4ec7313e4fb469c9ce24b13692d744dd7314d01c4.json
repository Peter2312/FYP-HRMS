{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import'./styles/LeaveHistory.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function LeaveHistory(){const[leaveRequests,setLeaveRequests]=useState([]);const[employeeId,setEmployeeId]=useState('');const navigate=useNavigate();// Fetch employee ID using the JWT token from localStorage\nuseEffect(()=>{const fetchEmployeeId=async()=>{try{const token=localStorage.getItem('token');if(!token){navigate('/login');return;}const response=await axios.get('http://localhost:5000/api/employees/me',{headers:{Authorization:`Bearer ${token}`}});setEmployeeId(response.data._id);}catch(error){console.error('Error fetching employee ID:',error);if(error.response&&error.response.status===401){navigate('/login');}}};fetchEmployeeId();},[navigate]);// Fetch leave requests based on employeeId\nuseEffect(()=>{const fetchLeaveRequests=async()=>{if(employeeId){try{const response=await axios.get(`http://localhost:5000/api/leaves/view/${employeeId}`);setLeaveRequests(response.data);}catch(error){console.error('Error fetching leave history:',error);}}};fetchLeaveRequests();},[employeeId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"leave-history-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Leave History\"}),leaveRequests.length>0?/*#__PURE__*/_jsx(\"ul\",{children:leaveRequests.map(req=>/*#__PURE__*/_jsxs(\"li\",{className:\"leave-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"leave-details\",children:[/*#__PURE__*/_jsx(\"strong\",{children:req.leaveType}),\": \",req.startDate.substring(0,10),\" to \",req.endDate.substring(0,10)]}),/*#__PURE__*/_jsx(\"div\",{className:`status ${req.status.toLowerCase()}`,children:req.status})]},req._id))}):/*#__PURE__*/_jsx(\"p\",{children:\"No leave history found.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"back-to-dashboard\",onClick:()=>navigate('/employee-dashboard'),children:\"Back to Dashboard\"})]});}export default LeaveHistory;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","LeaveHistory","leaveRequests","setLeaveRequests","employeeId","setEmployeeId","navigate","fetchEmployeeId","token","localStorage","getItem","response","get","headers","Authorization","data","_id","error","console","status","fetchLeaveRequests","className","children","length","map","req","leaveType","startDate","substring","endDate","toLowerCase","onClick"],"sources":["C:/Users/Asus/fyp/frontend/src/pages/employee/LeaveHistory.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './styles/LeaveHistory.css';\r\n\r\nfunction LeaveHistory() {\r\n  const [leaveRequests, setLeaveRequests] = useState([]);\r\n  const [employeeId, setEmployeeId] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  // Fetch employee ID using the JWT token from localStorage\r\n  useEffect(() => {\r\n    const fetchEmployeeId = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          navigate('/login');\r\n          return;\r\n        }\r\n\r\n        const response = await axios.get('http://localhost:5000/api/employees/me', {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`\r\n          }\r\n        });\r\n        setEmployeeId(response.data._id);\r\n      } catch (error) {\r\n        console.error('Error fetching employee ID:', error);\r\n        if (error.response && error.response.status === 401) {\r\n          navigate('/login');\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchEmployeeId();\r\n  }, [navigate]);\r\n\r\n  // Fetch leave requests based on employeeId\r\n  useEffect(() => {\r\n    const fetchLeaveRequests = async () => {\r\n      if (employeeId) {\r\n        try {\r\n          const response = await axios.get(`http://localhost:5000/api/leaves/view/${employeeId}`);\r\n          setLeaveRequests(response.data);\r\n        } catch (error) {\r\n          console.error('Error fetching leave history:', error);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchLeaveRequests();\r\n  }, [employeeId]);\r\n\r\n  return (\r\n    <div className=\"leave-history-container\">\r\n      <h2>Your Leave History</h2>\r\n      {leaveRequests.length > 0 ? (\r\n        <ul>\r\n          {leaveRequests.map((req) => (\r\n              <li key={req._id} className=\"leave-item\">\r\n              <div className=\"leave-details\">\r\n                <strong>{req.leaveType}</strong>: {req.startDate.substring(0, 10)} to {req.endDate.substring(0, 10)}\r\n              </div>\r\n              <div className={`status ${req.status.toLowerCase()}`}>{req.status}</div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      ) : (\r\n        <p>No leave history found.</p>\r\n      )}\r\n      {/* Back to Dashboard Button */}\r\n      <button className=\"back-to-dashboard\" onClick={() => navigate('/employee-dashboard')}>\r\n        Back to Dashboard\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LeaveHistory;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}