{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import'./styles/ApplyLeave.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ApplyLeave(){const[leaveType,setLeaveType]=useState('');const[startDate,setStartDate]=useState('');const[endDate,setEndDate]=useState('');const[employee,setEmployee]=useState({});const[message,setMessage]=useState('');const navigate=useNavigate();// For navigation\n// Fetch employee details using the JWT token from localStorage\nuseEffect(()=>{const fetchEmployeeDetails=async()=>{try{// Retrieve the token from localStorage\nconst token=localStorage.getItem('token');// If no token is found, redirect to login\nif(!token){navigate('/login');return;}// Send the token in the authorization header to fetch employee data\nconst response=await axios.get('http://localhost:5000/api/employees/me',{headers:{Authorization:`Bearer ${token}`}});// Set the employee data in state\nsetEmployee(response.data);}catch(error){console.error('Error fetching employee data:',error);// Handle unauthorized access, redirect to login\nif(error.response&&error.response.status===401){navigate('/login');}}};fetchEmployeeDetails();},[navigate]);const handleSubmit=async e=>{e.preventDefault();const leaveData={employeeId:employee._id,name:employee.name,leaveType,startDate,endDate};try{const response=await axios.post('http://localhost:5000/api/leaves/apply',leaveData);setMessage('LEAVE REQUEST SUBMITTED SUCCESSFULLY!');console.log(response.data);// Log response for debugging\n}catch(error){setMessage('Error requesting leave. Please try again.');console.error('Error requesting leave:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"apply-leave-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Apply for Leave\"}),employee.name&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Employee Name: \",/*#__PURE__*/_jsx(\"strong\",{children:employee.name})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"select\",{value:leaveType,onChange:e=>setLeaveType(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Leave Type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Annual Leave\",children:\"Annual Leave\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Sick Leave\",children:\"Sick Leave\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Vacation Leave\",children:\"Vacation Leave\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Casual Leave\",children:\"Casual Leave\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Start Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:startDate,onChange:e=>setStartDate(e.target.value),required:true}),/*#__PURE__*/_jsx(\"p\",{children:\"End Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:endDate,onChange:e=>setEndDate(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"submit-button\",type:\"submit\",children:\"Submit Leave Request\"})]}),message&&/*#__PURE__*/_jsx(\"p\",{children:message}),/*#__PURE__*/_jsx(\"button\",{className:\"back-to-dashboard\",onClick:()=>navigate('/employee-dashboard'),children:\"Back to Dashboard\"})]});}export default ApplyLeave;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","ApplyLeave","leaveType","setLeaveType","startDate","setStartDate","endDate","setEndDate","employee","setEmployee","message","setMessage","navigate","fetchEmployeeDetails","token","localStorage","getItem","response","get","headers","Authorization","data","error","console","status","handleSubmit","e","preventDefault","leaveData","employeeId","_id","name","post","log","className","children","onSubmit","value","onChange","target","required","type","onClick"],"sources":["C:/Users/Asus/fyp/frontend/src/pages/employee/ApplyLeave.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom'; \r\nimport './styles/ApplyLeave.css';\r\n\r\nfunction ApplyLeave() {\r\n  const [leaveType, setLeaveType] = useState('');\r\n  const [startDate, setStartDate] = useState('');\r\n  const [endDate, setEndDate] = useState('');\r\n  const [employee, setEmployee] = useState({}); \r\n  const [message, setMessage] = useState('');\r\n  const navigate = useNavigate(); // For navigation\r\n\r\n  // Fetch employee details using the JWT token from localStorage\r\n  useEffect(() => {\r\n    const fetchEmployeeDetails = async () => {\r\n      try {\r\n        // Retrieve the token from localStorage\r\n        const token = localStorage.getItem('token');\r\n        \r\n        // If no token is found, redirect to login\r\n        if (!token) {\r\n          navigate('/login');\r\n          return;\r\n        }\r\n\r\n        // Send the token in the authorization header to fetch employee data\r\n        const response = await axios.get('http://localhost:5000/api/employees/me', {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`\r\n          }\r\n        });\r\n\r\n        // Set the employee data in state\r\n        setEmployee(response.data);\r\n      } catch (error) {\r\n        console.error('Error fetching employee data:', error);\r\n        // Handle unauthorized access, redirect to login\r\n        if (error.response && error.response.status === 401) {\r\n          navigate('/login');\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchEmployeeDetails();\r\n  }, [navigate]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const leaveData = {\r\n      employeeId: employee._id, \r\n      name: employee.name,     \r\n      leaveType,\r\n      startDate,\r\n      endDate,\r\n    };\r\n\r\n    try {\r\n      const response = await axios.post('http://localhost:5000/api/leaves/apply', leaveData);\r\n      setMessage('LEAVE REQUEST SUBMITTED SUCCESSFULLY!');\r\n      console.log(response.data); // Log response for debugging\r\n    } catch (error) {\r\n      setMessage('Error requesting leave. Please try again.');\r\n      console.error('Error requesting leave:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"apply-leave-container\">\r\n      <h2>Apply for Leave</h2>\r\n      {employee.name && <p>Employee Name: <strong>{employee.name}</strong></p>}\r\n      <form onSubmit={handleSubmit}>\r\n        <select value={leaveType} onChange={(e) => setLeaveType(e.target.value)} required>\r\n          <option value=\"\">Select Leave Type</option>\r\n          <option value=\"Annual Leave\">Annual Leave</option>\r\n          <option value=\"Sick Leave\">Sick Leave</option>\r\n          <option value=\"Vacation Leave\">Vacation Leave</option>\r\n          <option value=\"Casual Leave\">Casual Leave</option>\r\n        </select>\r\n        <p>Start Date</p> \r\n        <input \r\n          type=\"date\"\r\n          value={startDate} \r\n          onChange={(e) => setStartDate(e.target.value)} \r\n          required \r\n        />\r\n        <p>End Date</p> \r\n        <input \r\n          type=\"date\" \r\n          value={endDate} \r\n          onChange={(e) => setEndDate(e.target.value)} \r\n          required \r\n        />\r\n        <button className=\"submit-button\" type=\"submit\">Submit Leave Request</button>\r\n      </form>\r\n      {message && <p>{message}</p>}\r\n\r\n      {/* Back to Dashboard Button */}\r\n      <button className=\"back-to-dashboard\" onClick={() => navigate('/employee-dashboard')}>\r\n        Back to Dashboard\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ApplyLeave;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}